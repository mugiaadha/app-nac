<div class="certificates-page">
  <!-- Page Header -->
  <div class="content-card mb-4">
    <div class="card-header">
      <h4 class="mb-0">
        <i class="bi bi-award me-2"></i>My Certificates
      </h4>
      <p class="text-muted mb-0 mt-2">View and download your earned certificates</p>
    </div>
  </div>

  <!-- Certificates Stats -->
  <div class="row g-4 mb-4">
    <div class="col-md-4">
      <div class="stats-card text-center">
        <div class="stats-icon bg-grow-early mx-auto mb-3">
          <i class="bi bi-award"></i>
        </div>
        <h3>{{ getIssuedCount() }}</h3>
        <p class="text-muted">Certificates Earned</p>
      </div>
    </div>
    <div class="col-md-4">
      <div class="stats-card text-center">
        <div class="stats-icon bg-sunny-morning mx-auto mb-3">
          <i class="bi bi-clock"></i>
        </div>
        <h3>{{ getPendingCount() }}</h3>
        <p class="text-muted">Pending Certificates</p>
      </div>
    </div>
    <div class="col-md-4">
      <div class="stats-card text-center">
        <div class="stats-icon bg-info mx-auto mb-3">
          <i class="bi bi-graph-up"></i>
        </div>
        <h3>{{ getAverageScore() }}%</h3>
        <p class="text-muted">Average Score</p>
      </div>
    </div>
  </div>

  <!-- Certificates List -->
  <div class="content-card">
    <div class="card-header">
      <h5 class="mb-0">
        <i class="bi bi-list-ul me-2"></i>Certificate List
      </h5>
    </div>
    <div class="card-body">
      <div class="certificates-grid">
        <div *ngFor="let certificate of certificates" class="certificate-card">
          <div class="certificate-image">
            <img [src]="certificate.courseImage" [alt]="certificate.courseName" class="rounded">
            <div class="certificate-overlay">
              <span class="badge certificate-status" [class]="getStatusBadgeClass(certificate.status)">
                {{ getStatusText(certificate.status) }}
              </span>
            </div>
          </div>
          
          <div class="certificate-content">
            <div class="certificate-header">
              <h6 class="certificate-title">{{ certificate.courseName }}</h6>
              <div class="certificate-score">
                <span class="score-badge">{{ certificate.completionScore }}%</span>
              </div>
            </div>
            
            <div class="certificate-meta">
              <div class="meta-item">
                <i class="bi bi-person text-muted me-1"></i>
                <small class="text-muted">{{ certificate.instructor }}</small>
              </div>
              <div class="meta-item">
                <i class="bi bi-calendar text-muted me-1"></i>
                <small class="text-muted">{{ certificate.issueDate | date:'mediumDate' }}</small>
              </div>
              <div class="meta-item">
                <i class="bi bi-hash text-muted me-1"></i>
                <small class="text-muted">{{ certificate.certificateNumber }}</small>
              </div>
            </div>
            
            <div class="certificate-actions mt-3">
              <button 
                *ngIf="certificate.status === 'issued'" 
                (click)="downloadCertificate(certificate)"
                class="btn btn-primary bg-malibu-purple btn-sm me-2"
              >
                <i class="bi bi-download me-1"></i>Download
              </button>
              <button 
                class="btn btn-outline-primary btn-sm me-2"
                (click)="previewCertificate(certificate)"
              >
                <i class="bi bi-eye me-1"></i>View
              </button>
              <span *ngIf="certificate.status === 'pending'" class="text-warning">
                <i class="bi bi-clock me-1"></i>Processing...
              </span>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Empty State -->
      <div *ngIf="certificates.length === 0" class="text-center py-5">
        <i class="bi bi-award text-muted" style="font-size: 4rem;"></i>
        <h5 class="text-muted mt-3">No Certificates Yet</h5>
        <p class="text-muted">Complete courses to earn your first certificate!</p>
        <a href="/courses" class="btn btn-primary bg-malibu-purple-gradient">
          <i class="bi bi-book me-1"></i>Browse Courses
        </a>
      </div>
    </div>
  </div>
</div>

<!-- Certificate Preview Modal -->
<div class="modal fade" [class.show]="showCertificateModal" [style.display]="showCertificateModal ? 'block' : 'none'" 
     id="certificateModal" tabindex="-1" *ngIf="showCertificateModal">
  <div class="modal-dialog modal-xl modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">
          <i class="bi bi-award me-2"></i>Certificate Preview
        </h5>
        <button type="button" class="btn-close" (click)="closeCertificateModal()"></button>
      </div>
      <div class="modal-body p-0">
        <app-certificate-template 
          *ngIf="selectedCertificateData"
          [certificateData]="selectedCertificateData"
          [showActions]="true"
          [size]="'medium'">
        </app-certificate-template>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="closeCertificateModal()">
          Close
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Modal backdrop -->
<div class="modal-backdrop fade" [class.show]="showCertificateModal" *ngIf="showCertificateModal" 
     (click)="closeCertificateModal()"></div>
